# Makefile –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ APK –§–µ—Ä–º–µ—Ä—Å–∫–æ–≥–æ –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞

.PHONY: all clean install-flutter build-apk check-flutter

all: check-flutter build-apk

check-flutter:
	@echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Flutter..."
	@if ! command -v flutter >/dev/null 2>&1; then \
		echo "‚ùå Flutter –Ω–µ –Ω–∞–π–¥–µ–Ω!"; \
		echo "üîß –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Flutter..."; \
		$(MAKE) install-flutter; \
	else \
		echo "‚úÖ Flutter –Ω–∞–π–¥–µ–Ω!"; \
	fi

install-flutter:
	@echo "üì• –°–∫–∞—á–∏–≤–∞–µ–º Flutter SDK..."
	@if [ ! -d "flutter" ]; then \
		wget -O flutter.tar.xz "https://storage.googleapis.com/flutter_infra_release/releases/stable/linux/flutter_linux_3.16.5-stable.tar.xz"; \
		tar -xf flutter.tar.xz; \
		rm flutter.tar.xz; \
		echo "‚úÖ Flutter SDK —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"; \
	else \
		echo "‚úÖ Flutter —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"; \
	fi

build-apk: check-flutter
	@echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..."
	@flutter pub get
	@echo "üèóÔ∏è –°–æ–±–∏—Ä–∞–µ–º APK..."
	@flutter build apk --release
	@echo "‚úÖ APK —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!"
	@echo "üì± –§–∞–π–ª: build/app/outputs/flutter-apk/app-release.apk"
	@echo "üìè –†–∞–∑–º–µ—Ä: ~15-20 MB"
	@echo "üì± –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: Android 5.0+"

clean:
	@echo "üßπ –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..."
	@flutter clean
	@rm -rf build/
	@echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

help:
	@echo "üå± –§–ï–†–ú–ï–†–°–ö–ò–ô –ú–ê–†–ö–ï–¢–ü–õ–ï–ô–° - –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –°–ë–û–†–ö–ê APK"
	@echo "============================================================"
	@echo "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
	@echo "  make all          - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Flutter –∏ —Å–æ–±—Ä–∞—Ç—å APK"
	@echo "  make build-apk     - –°–æ–±—Ä–∞—Ç—å APK (—Ç—Ä–µ–±—É–µ—Ç Flutter)"
	@echo "  make install-flutter - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Flutter SDK"
	@echo "  make check-flutter - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ Flutter"
	@echo "  make clean         - –û—á–∏—Å—Ç–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã"
	@echo "  make help          - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É"
	@echo ""
	@echo "üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω —Å–µ—Ä–≤–∏—Å https://replit.com/"
